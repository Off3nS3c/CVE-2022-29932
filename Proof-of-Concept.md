# **CVE-2022-29932 - Primeur Spazio Information Disclosure (Memory Leak)**

### Description
The HTTP Server in PRIMEUR SPAZIO 2.5.1.954 (File Transfer) allows a remote unauthenticated attacker to obtain sensitive data (related to the content of transferred files) via a crafted HTTP request.

Vendor has acknowledged the vulnerability and promptly notified all impacted customers and provided a patch.

### Affected Product Code Base
Primeur Spazio - 2.5.1.954

### Attack Vectors
In order to exploit the vulnerability, an unauthenticated attacker should send crafted HTTP Request

### Discovered by
Andrea Mattiazzo, Alessandro Cudini, Antonio Montesano, Giovanni Battista Colonna

### Reference
https://www.primeur.com/managed-file-transfer

#
#


## **Proof-of-Concept (POC)**

Navigating the website without any kind of credentials and executing fuzzing on the root directory, it has been observed web resources built at real-time.

<img width="220" alt="ffuz" src="https://user-images.githubusercontent.com/104774764/166256775-b1d3268b-25ae-461f-85eb-22e30b7a6f38.png">

After an in-depth analysis it was observed those resources are strictly related to already existent data directories on the web server.

<img width="336" alt="MicrosoftTeams-image (4)" src="https://user-images.githubusercontent.com/104774764/166257352-b1918e75-ca71-471a-b94d-5b617c1b9f8b.png">

Creating a crafted HTTP request pointing to these data directories cutting the trailing "/" character, the web server answers an unmanaged memory leak in HTTP response.
As an example we created two folders on the webserver called "assets" and "pippo" in order to reproduce the unsecure behaviour obtaining the memory leak.
 
<img width="587" alt="MicrosoftTeams-image (2)" src="https://user-images.githubusercontent.com/104774764/166257226-0f0e89d7-74ca-4573-a984-16569280be8e.png">
<img width="624" alt="MicrosoftTeams-image (3)" src="https://user-images.githubusercontent.com/104774764/166257246-c1f8360d-28a2-4a09-8d9d-082ea04c1777.png">

By downloading or navigating the resource containing the memory leak, it has been possible to navigate the exfiltrated buffer of memory which contained the content of exchanged files by authorized users leading to an information leakage.
  
<img width="826" alt="Assets_cleaned" src="https://user-images.githubusercontent.com/104774764/166257427-ebb2b682-ff29-428c-a464-836956ed33d2.png">
